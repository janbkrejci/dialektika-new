---
layout: page
permalink: /aktivity
---
<script>
  // return back if already logged in
  if (!localStorage.pocketbase_auth) {
    back()
  }
</script>
<div x-data="aktivity" x-show="user_id" x-effect="if (!user_id) back();">
  <h1>Aktivity</h1>

  <!-- navigation -->
  <div class="flex grow justify-between">
    <a href="" @click.prevent="switchState('hlasovani')">Hlasování</a>
    <a href="" @click.prevent="switchState('vysledky')">Výsledky</a>
    <a href="" @click.prevent="switchState('other')">Něco jiného...</a>
  </div>

  <div class="separator mt-8"></div>

  <!-- results -->
  <div x-show="state === 'vysledky'">
    <h2>Výsledky hlasování</h2>

    <table class="table-auto">
      <thead>
        <tr>
          <th>Odhlasováno</th>
          <th>Návrh</th>
          <th class="text-center">Výsledek</th>
        </tr>
      </thead>
      <tbody>
        <tr id="H0" @click="showDetail($el.id)">
          <td>31. 3. 2023</td>
          <td>Úprava Stanov - zrušení čl. 2.2</td>
          <td class="text-center">
            <div class="btn success">Schváleno</div>
          </td>
        </tr>
        <tr id="H1" @click="showDetail($el.id)">
          <td>15. 3. 2023</td>
          <td>Svolání mimořádné členské schůze</td>
          <td class="text-center">
            <div class="btn error">Zamítnuto</div>
          </td>
        </tr>
      </tbody>
    </table>

    <h2>Zamítnutá témata</h2>

    <table class="table-auto">
      <thead>
        <tr>
          <th>Zamítnuto</th>
          <th>Návrh</th>
          <th class="text-center">Akce</th>
        </tr>
      </thead>
      <tbody>
        <tr id="H5" @click="showDetail($el.id)">
          <td>31. 3. 2023</td>
          <td>Úprava Stanov - zrušení čl. 2.2</td>
          <td class="text-center">
            <button id="H5" class="primary" @click.stop="reOpen($el.id)">Znovu otevřít</button>
          </td>
        </tr>
        <tr id="H6" @click="showDetail($el.id)">
          <td>15. 3. 2023</td>
          <td>Svolání mimořádné členské schůze</td>
          <td class="text-center">
            <button id="H6" class="primary" @click.stop="reOpen($el.id)">Znovu otevřít</button>
          </td>
        </tr>
      </tbody>
    </table>

  </div>

  <!-- voting -->
  <div x-show="state === 'hlasovani'">
    <h2>Moje hlasování:</h2>

    <table class="table-auto">
      <thead>
        <tr>
          <th>Termín</th>
          <th>Návrh</th>
          <th class="text-center">Hlasovat</th>
        </tr>
      </thead>
      <tbody>
        <tr id="H2" @click="showDetail($el.id)">
          <td>31. 3. 2023</td>
          <td>Aktualizace Stanov - čl. 2.3</td>
          <td class="text-center">
            <button class="success" @click.stop="vote($el.id, true)">PRO</button>
            <button class="error" @click.stop="vote($el.id, false)">PROTI</button>
          </td>
        </tr>
      </tbody>
    </table>

    <h2>Témata v diskusi:</h2>

    <div class="alert success px-2">
      V tuto chvíli žádná diskuse neprobíhá.
    </div>

    <h2>Navržená témata:</h2>

    <table>
      <thead>
        <tr>
          <th>Termín</th>
          <th>Návrh</th>
          <th class="text-center">Pustit k diskusi</th>
        </tr>
      </thead>
      <tbody>
        <template x-for="item in suggestedItems">
          <tr :id="item.id" @click="showDetail(item.id)">
            <td>31. 3. 2023</td>
            <td x-text="item.subject"></td>
            <td class="text-center">
              <button class="success" @click.stop="vote(item.id, true)">ANO</button>
              <button class="error" @click.stop="vote(item.id, false)">NE</button>
            </td>
          </tr>
        </template>
      </tbody>
    </table>

    <button class="primary" @click="showDetail(null)">Podat návrh na téma</button>
  </div>

  <!-- detail -->
  <div x-show="state === 'detail'" @keyup.escape.window="hideDetail()" @keydown.enter.stop="next"
    @keyup.ctrl.enter.stop="next">
    <button class="primary" @click="hideDetail()">&lt;&lt; Zpět</button>
    <h2 class="mt-4">
      <span x-show="selectedItem.state === 'closed'">Uzavřené hlasování</span>
      <span x-show="selectedItem.state === 'voting'">Hlasování</span>
      <span x-show="selectedItem.state === 'elaborating'">Téma v diskusi</span>
      <span x-show="selectedItem.state === 'rejected'">Zamítnuté téma</span>
      <span x-show="selectedItem.state === 'suggested'">Navržené téma</span>
      <span x-show="selectedItem.state === 'new'">Nové téma</span>
    </h2>

    <div class="alert error px-2" x-show="errors.submitError" x-text="errors.submitError"></div>

    <div x-show="selectedItem.state === 'new'">
      <label for="subject">Předmět *</label>
      <input id="subject" :class="{'input': true, 'error': errors.subjectError}" type="text"
        x-model="selectedItem.subject" @input="selectedItem.subject = $el.value" @blur="validate($el.id)">
      <div class="error-text" x-text="errors.subjectError"></div>
    </div>

    <div x-show="selectedItem.state === 'new'">
      <label for="description">Popis *</label>
      <textarea id="description" :class="{'input': true, 'error': errors.descriptionError}"
        x-model="selectedItem.description" @input="selectedItem.description = $el.value" @keydown.enter.stop="() => {}"
        @blur="validate($el.id)"></textarea>
      <div class="error-text" x-text="errors.descriptionError"></div>
    </div>

  </div>

  <div x-show="state === 'other'">
    <h2>Něco jiného</h2>
  </div>
</div>